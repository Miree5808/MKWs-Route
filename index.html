<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Route Note (Sheet Ver)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        body { font-family: sans-serif; background-color: #202124; color: #e8eaed; padding: 20px; max-width: 600px; margin: 0 auto; }
        h1 { text-align: center; font-size: 1.5rem; }
        .search-box { background: #303134; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #8ab4f8; }
        select { width: 100%; padding: 10px; margin-bottom: 15px; background: #202124; color: white; border: 1px solid #5f6368; border-radius: 4px; }
        #result-area { display: none; background: #3c4043; padding: 20px; border-radius: 8px; border-left: 5px solid #8ab4f8; }
        .note-content { white-space: pre-wrap; line-height: 1.6; }
        .loading { text-align: center; color: #fbbc04; }
    </style>
</head>
<body>

    <h1>ğŸ® ãƒ«ãƒ¼ãƒˆæ”»ç•¥ï¼ˆSheeté€£å‹•ï¼‰</h1>

    <div id="loading-msg" class="loading">ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ä¸­...</div>

    <div class="search-box" id="main-ui" style="display:none;">
        <label>START</label>
        <select id="start-select" onchange="findRoute()"><option value="">é¸æŠã—ã¦ãã ã•ã„</option></select>
        <label>GOAL</label>
        <select id="end-select" onchange="findRoute()"><option value="">é¸æŠã—ã¦ãã ã•ã„</option></select>
    </div>

    <div id="result-area">
        <div style="font-weight:bold; margin-bottom:10px;">ğŸ“ æ”»ç•¥ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯</div>
        <div id="note-text" class="note-content"></div>
    </div>

    <script>
        // â–¼â–¼â–¼ ã“ã“ã«ã€Œã‚¦ã‚§ãƒ–ã«å…¬é–‹ã€ã§å–å¾—ã—ãŸCSVã®URLã‚’è²¼ã‚‹ â–¼â–¼â–¼
        const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRGCuHHt7237RMl1ib0ZCfhczvmp0Sz7oWoJ0QrBaZgYqpLBJjBgOgiKJGUBhJX9E-Jg3Hew1LKq4rZ/pub?output=csv"; 
        // â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²

        let routeData = [];

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’å–å¾—
        window.onload = function() {
            Papa.parse(SHEET_URL, {
                download: true,
                header: true, // 1è¡Œç›®ã‚’ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ã—ã¦æ‰±ã†
                complete: function(results) {
                    routeData = results.data;
                    initSelectBoxes();
                    document.getElementById('loading-msg').style.display = 'none';
                    document.getElementById('main-ui').style.display = 'block';
                },
                error: function(err) {
                    alert("ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚URLã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚");
                }
            });
        };

        const startSelect = document.getElementById('start-select');
        const endSelect = document.getElementById('end-select');

        function initSelectBoxes() {
            const allPoints = new Set();
            routeData.forEach(d => {
                if(d.start && d.end) { // ç©ºè¡Œå¯¾ç­–
                    allPoints.add(d.start);
                    allPoints.add(d.end);
                }
            });

            allPoints.forEach(point => {
                const opt = document.createElement('option');
                opt.value = opt.text = point;
                startSelect.add(opt);
                endSelect.add(opt.cloneNode(true));
            });
        }

        function findRoute() {
            const sv = startSelect.value;
            const ev = endSelect.value;
            const resArea = document.getElementById('result-area');
            
            if (!sv || !ev) { resArea.style.display = 'none'; return; }

            // ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®åˆ—åã«åˆã‚ã›ã¦æ¤œç´¢ (start, end)
            const found = routeData.find(d => d.start === sv && d.end === ev);
            
            if (found) {
                document.getElementById('note-text').textContent = found.note;
                resArea.style.display = 'block';
            } else {
                resArea.style.display = 'none';
            }
        }
    </script>
</body>
</html>